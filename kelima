-- Auto Training Script untuk meningkatkan Combat Power
-- Optimized for Delta Executor
-- Fixed Version with Better Error Handling

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer

-- Variabel Global
local autoTrainEnabled = false
local selectedTrainingType = "arms"
local trainingSpeed = 4
local trainingDelay = 0.01
local isMinimized = false

-- Safe function to get remote
local function getRemote(path)
    local success, result = pcall(function()
        local current = ReplicatedStorage
        for _, name in ipairs(path) do
            current = current:FindFirstChild(name)
            if not current then return nil end
        end
        return current
    end)
    return success and result or nil
end

-- Training Types
local TrainingTypes = {
    arms = "Training_2001",
    legs = "Training_2002",
    back = "Training_2003",
    agility = "Training_2004"
}

-- Fungsi Auto Train dengan Error Handling
local function startAutoTrain()
    spawn(function()
        while autoTrainEnabled do
            local success = pcall(function()
                -- Try to get remotes
                local ApplyMobileTrain = getRemote({"TrainEquipment", "Remote", "ApplyMobileTrain"})
                local TrainSpeedHasChanged = getRemote({"TrainSystem", "Remote", "TrainSpeedHasChanged"})
                local ApplyBindingTrainingEffect = getRemote({"TrainEquipment", "Remote", "ApplyBindingTrainingEffect"})
                local ApplyBindingTrainingBoostEffect = getRemote({"TrainEquipment", "Remote", "ApplyBindingTrainingBoostEffect"})
                local ApplyStationaryTrain = getRemote({"TrainEquipment", "Remote", "ApplyStationaryTrain"})
                
                -- Execute training
                if ApplyMobileTrain then
                    ApplyMobileTrain:InvokeServer()
                end
                
                if TrainSpeedHasChanged then
                    TrainSpeedHasChanged:FireServer(trainingSpeed)
                end
                
                if ApplyBindingTrainingEffect then
                    local trainingId = TrainingTypes[selectedTrainingType]
                    if trainingId then
                        ApplyBindingTrainingEffect:InvokeServer(trainingId, "Emit_2")
                    end
                end
                
                if ApplyBindingTrainingBoostEffect then
                    ApplyBindingTrainingBoostEffect:InvokeServer()
                end
                
                if ApplyStationaryTrain then
                    ApplyStationaryTrain:InvokeServer()
                end
            end)
            
            if not success then
                warn("Training error - will retry")
            end
            
            task.wait(trainingDelay)
        end
    end)
end

-- GUI Creation
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "AutoTrainGUI"
ScreenGui.ResetOnSpawn = false

-- Check if GUI already exists
local existingGui = game.CoreGui:FindFirstChild("AutoTrainGUI")
if existingGui then
    existingGui:Destroy()
end

ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.35, 0, 0.25, 0)
MainFrame.Size = UDim2.new(0, 350, 0, 500)
MainFrame.ClipsDescendants = true

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 12)
MainCorner.Parent = MainFrame

-- Title Bar
local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Parent = MainFrame
TitleBar.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
TitleBar.BorderSizePixel = 0
TitleBar.Size = UDim2.new(1, 0, 0, 50)

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 12)
TitleCorner.Parent = TitleBar

-- Make draggable
local dragging
local dragInput
local dragStart
local startPos

local function update(input)
    local delta = input.Position - dragStart
    MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

TitleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- Title
local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Parent = TitleBar
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 15, 0, 0)
Title.Size = UDim2.new(0.6, 0, 1, 0)
Title.Font = Enum.Font.GothamBold
Title.Text = "âš¡ Combat Power Booster"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18
Title.TextXAlignment = Enum.TextXAlignment.Left

-- Minimize Button
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Parent = TitleBar
MinimizeButton.BackgroundColor3 = Color3.fromRGB(255, 180, 0)
MinimizeButton.Position = UDim2.new(0.82, 0, 0.25, 0)
MinimizeButton.Size = UDim2.new(0, 25, 0, 25)
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.Text = "â€”"
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.TextSize = 16

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 6)
MinCorner.Parent = MinimizeButton

-- Close Button
local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Parent = TitleBar
CloseButton.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
CloseButton.Position = UDim2.new(0.91, 0, 0.25, 0)
CloseButton.Size = UDim2.new(0, 25, 0, 25)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Text = "Ã—"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 20

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 6)
CloseCorner.Parent = CloseButton

-- Content Frame
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = MainFrame
ContentFrame.BackgroundTransparency = 1
ContentFrame.Position = UDim2.new(0, 0, 0, 50)
ContentFrame.Size = UDim2.new(1, 0, 1, -50)

-- Status Label
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Name = "StatusLabel"
StatusLabel.Parent = ContentFrame
StatusLabel.BackgroundTransparency = 1
StatusLabel.Position = UDim2.new(0.1, 0, 0.02, 0)
StatusLabel.Size = UDim2.new(0.8, 0, 0, 30)
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.Text = "Status: Inactive â­•"
StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
StatusLabel.TextSize = 14

-- Toggle Button
local ToggleButton = Instance.new("TextButton")
ToggleButton.Name = "ToggleButton"
ToggleButton.Parent = ContentFrame
ToggleButton.BackgroundColor3 = Color3.fromRGB(60, 180, 80)
ToggleButton.Position = UDim2.new(0.15, 0, 0.09, 0)
ToggleButton.Size = UDim2.new(0.7, 0, 0, 40)
ToggleButton.Font = Enum.Font.GothamBold
ToggleButton.Text = "START AUTO TRAIN"
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.TextSize = 16

local ToggleCorner = Instance.new("UICorner")
ToggleCorner.CornerRadius = UDim.new(0, 8)
ToggleCorner.Parent = ToggleButton

-- Training Type Label
local TrainTypeLabel = Instance.new("TextLabel")
TrainTypeLabel.Name = "TrainTypeLabel"
TrainTypeLabel.Parent = ContentFrame
TrainTypeLabel.BackgroundTransparency = 1
TrainTypeLabel.Position = UDim2.new(0.1, 0, 0.21, 0)
TrainTypeLabel.Size = UDim2.new(0.8, 0, 0, 25)
TrainTypeLabel.Font = Enum.Font.GothamBold
TrainTypeLabel.Text = "Training Type:"
TrainTypeLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TrainTypeLabel.TextSize = 14
TrainTypeLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Training Type Buttons
local function createTypeButton(name, position, yPos)
    local btn = Instance.new("TextButton")
    btn.Name = name .. "Button"
    btn.Parent = ContentFrame
    btn.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
    btn.Position = UDim2.new(position, 0, yPos, 0)
    btn.Size = UDim2.new(0.35, 0, 0, 35)
    btn.Font = Enum.Font.Gotham
    btn.Text = name:upper()
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.TextSize = 13
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 6)
    btnCorner.Parent = btn
    
    return btn
end

local ArmsButton = createTypeButton("Arms", 0.1, 0.28)
local LegsButton = createTypeButton("Legs", 0.55, 0.28)
local BackButton = createTypeButton("Back", 0.1, 0.37)
local AgilityButton = createTypeButton("Agility", 0.55, 0.37)

-- Set default
ArmsButton.BackgroundColor3 = Color3.fromRGB(80, 150, 255)

-- Button click handlers
local function updateTrainingType(btn, type)
    btn.MouseButton1Click:Connect(function()
        selectedTrainingType = type
        ArmsButton.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
        LegsButton.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
        BackButton.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
        AgilityButton.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
        btn.BackgroundColor3 = Color3.fromRGB(80, 150, 255)
    end)
end

updateTrainingType(ArmsButton, "arms")
updateTrainingType(LegsButton, "legs")
updateTrainingType(BackButton, "back")
updateTrainingType(AgilityButton, "agility")

-- Speed Label
local SpeedLabel = Instance.new("TextLabel")
SpeedLabel.Name = "SpeedLabel"
SpeedLabel.Parent = ContentFrame
SpeedLabel.BackgroundTransparency = 1
SpeedLabel.Position = UDim2.new(0.1, 0, 0.48, 0)
SpeedLabel.Size = UDim2.new(0.8, 0, 0, 25)
SpeedLabel.Font = Enum.Font.GothamBold
SpeedLabel.Text = "Training Speed: " .. trainingSpeed
SpeedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedLabel.TextSize = 14
SpeedLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Speed Button
local SpeedSlider = Instance.new("TextButton")
SpeedSlider.Name = "SpeedSlider"
SpeedSlider.Parent = ContentFrame
SpeedSlider.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
SpeedSlider.Position = UDim2.new(0.1, 0, 0.54, 0)
SpeedSlider.Size = UDim2.new(0.8, 0, 0, 30)
SpeedSlider.Font = Enum.Font.Gotham
SpeedSlider.Text = "Increase Speed +"
SpeedSlider.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedSlider.TextSize = 12

local SpeedCorner = Instance.new("UICorner")
SpeedCorner.CornerRadius = UDim.new(0, 6)
SpeedCorner.Parent = SpeedSlider

SpeedSlider.MouseButton1Click:Connect(function()
    trainingSpeed = trainingSpeed + 1
    if trainingSpeed > 10 then trainingSpeed = 1 end
    SpeedLabel.Text = "Training Speed: " .. trainingSpeed
end)

-- Delay Label
local DelayLabel = Instance.new("TextLabel")
DelayLabel.Name = "DelayLabel"
DelayLabel.Parent = ContentFrame
DelayLabel.BackgroundTransparency = 1
DelayLabel.Position = UDim2.new(0.1, 0, 0.63, 0)
DelayLabel.Size = UDim2.new(0.8, 0, 0, 25)
DelayLabel.Font = Enum.Font.GothamBold
DelayLabel.Text = "Delay (seconds):"
DelayLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
DelayLabel.TextSize = 14
DelayLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Delay Input
local DelayInput = Instance.new("TextBox")
DelayInput.Name = "DelayInput"
DelayInput.Parent = ContentFrame
DelayInput.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
DelayInput.Position = UDim2.new(0.1, 0, 0.69, 0)
DelayInput.Size = UDim2.new(0.8, 0, 0, 30)
DelayInput.Font = Enum.Font.Gotham
DelayInput.PlaceholderText = "0.01 (recommended)"
DelayInput.Text = "0.01"
DelayInput.TextColor3 = Color3.fromRGB(255, 255, 255)
DelayInput.TextSize = 13

local DelayCorner = Instance.new("UICorner")
DelayCorner.CornerRadius = UDim.new(0, 6)
DelayCorner.Parent = DelayInput

DelayInput.FocusLost:Connect(function()
    local newDelay = tonumber(DelayInput.Text)
    if newDelay and newDelay >= 0.01 then
        trainingDelay = newDelay
    else
        DelayInput.Text = tostring(trainingDelay)
    end
end)

-- Combat Power Label
local CombatPowerLabel = Instance.new("TextLabel")
CombatPowerLabel.Name = "CombatPowerLabel"
CombatPowerLabel.Parent = ContentFrame
CombatPowerLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
CombatPowerLabel.Position = UDim2.new(0.1, 0, 0.81, 0)
CombatPowerLabel.Size = UDim2.new(0.8, 0, 0, 35)
CombatPowerLabel.Font = Enum.Font.GothamBold
CombatPowerLabel.Text = "Combat Power: Loading..."
CombatPowerLabel.TextColor3 = Color3.fromRGB(255, 200, 0)
CombatPowerLabel.TextSize = 13

local CPCorner = Instance.new("UICorner")
CPCorner.CornerRadius = UDim.new(0, 6)
CPCorner.Parent = CombatPowerLabel

-- Update Combat Power
spawn(function()
    while wait(2) do
        pcall(function()
            local GetCombatPower = getRemote({"TrainSystem", "Bindable", "GetCombatPower"})
            if GetCombatPower then
                local cp = GetCombatPower:Invoke(player)
                if cp then
                    CombatPowerLabel.Text = "Combat Power: " .. tostring(cp)
                end
            end
        end)
    end
end)

-- Minimize Function
local function toggleMinimize()
    isMinimized = not isMinimized
    
    if isMinimized then
        MainFrame:TweenSize(UDim2.new(0, 350, 0, 50), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.3, true)
        MinimizeButton.Text = "â–¡"
        ContentFrame.Visible = false
    else
        MainFrame:TweenSize(UDim2.new(0, 350, 0, 500), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.3, true)
        MinimizeButton.Text = "â€”"
        wait(0.1)
        ContentFrame.Visible = true
    end
end

MinimizeButton.MouseButton1Click:Connect(toggleMinimize)

-- Close Function
CloseButton.MouseButton1Click:Connect(function()
    autoTrainEnabled = false
    MainFrame:TweenSize(UDim2.new(0, 0, 0, 0), Enum.EasingDirection.In, Enum.EasingStyle.Back, 0.3, true)
    wait(0.3)
    ScreenGui:Destroy()
end)

-- Toggle Training
ToggleButton.MouseButton1Click:Connect(function()
    autoTrainEnabled = not autoTrainEnabled
    
    if autoTrainEnabled then
        ToggleButton.Text = "STOP AUTO TRAIN"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
        StatusLabel.Text = "Status: Active âœ…"
        StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        startAutoTrain()
    else
        ToggleButton.Text = "START AUTO TRAIN"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(60, 180, 80)
        StatusLabel.Text = "Status: Inactive â­•"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
    end
end)

print("âœ… Auto Training Script Loaded Successfully!")
print("ðŸ“Š GUI Created - Ready to use")
print("ðŸŽ¯ Drag title bar to move | â€” minimize | Ã— close")
